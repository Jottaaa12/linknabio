document.addEventListener('DOMContentLoaded',()=>{const secondaryPixKey='pix@acaisabordaterra.com.br';const merchantName='Nayara Santos de Araujo';const merchantCity='BARROQUINHA';const baseUrl='https://acaisabordaterra.com.br/pix/cob/';const qrCanvas=document.getElementById('qr-code');const pixValueInput=document.getElementById('pix-value');const generateQrBtn=document.getElementById('generate-qr');const showSecondaryKeyBtn=document.getElementById('show-secondary-key');const secondaryKeyP=document.getElementById('secondary-key');const copySecondaryKeyBtn=document.getElementById('copy-secondary-key');function formatField(id,value){const length=value.length.toString().padStart(2,'0');return id+length+value;}function generateBrCode(value=null){const txid='txid'+Date.now();const dynamicUrl=baseUrl+txid;const payload=[formatField('00','01'),formatField('26',formatField('00','br.gov.bcb.pix')+formatField('25',dynamicUrl)),formatField('52','0000'),formatField('53','986'),formatField('58','BR'),formatField('59',merchantName.substring(0,25)),formatField('60',merchantCity.substring(0,15))];if(value){payload.push(formatField('54',parseFloat(value).toFixed(2)));}payload.push(formatField('62',formatField('05',txid)));let payloadString=payload.join('');payloadString+='6304';let crc=0xFFFF;for(let i=0;i<payloadString.length;i++){crc^=(payloadString.charCodeAt(i)&0xFF)<<8;for(let j=0;j<8;j++){crc=(crc&0x8000)?(crc<<1)^0x1021:crc<<1;}}const crc16=(crc&0xFFFF).toString(16).toUpperCase().padStart(4,'0');return payloadString+crc16;}function generateQrCode(brCode){new QRious({element:qrCanvas,value:brCode,size:200,level:'H'});}function copyToClipboard(text,btn){navigator.clipboard.writeText(text).then(()=>{const originalIcon=btn.innerHTML;btn.innerHTML='<i class="fas fa-check"></i>';setTimeout(()=>{btn.innerHTML=originalIcon;},2000);});}generateQrCode(generateBrCode());generateQrBtn.addEventListener('click',()=>{const value=pixValueInput.value;generateQrCode(generateBrCode(value));});showSecondaryKeyBtn.addEventListener('click',()=>{secondaryKeyP.classList.toggle('hidden');});copySecondaryKeyBtn.addEventListener('click',()=>copyToClipboard(secondaryPixKey,copySecondaryKeyBtn));});